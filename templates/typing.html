<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ImagPeel Type Test</title>
    <link rel="icon" href="static/icon.png">
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            color: #333;
        }
        
        html {
            height: 100%;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .control-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select, button {
            padding: 8px 16px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        button:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .typing-area {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-bar {
            height: 4px;
            background: #f0f0f0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .text-display {
            padding: 30px;
            font-size: 1.2rem;
            line-height: 1.8;
            font-family: 'Courier New', monospace;
            min-height: 150px;
            position: relative;
            white-space: normal;
            word-wrap: break-word;
        }

        .char {
            position: relative;
        }

        .char.correct {
            background-color: #d4edda;
            color: #155724;
        }

        .char.incorrect {
            background-color: #f8d7da;
            color: #721c24;
        }

        .char.current {
            background-color: #667eea;
            color: white;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        .input-area {
            padding: 20px 30px;
            border-top: 1px solid #eee;
        }

        .typing-input {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .typing-input:focus {
            border-color: #667eea;
        }

        .results {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            display: none;
        }

        .results.show {
            display: block;
        }

        .results h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .lesson-selector {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .lesson-card {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .lesson-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .lesson-card.active {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .accuracy-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .accuracy-excellent { background: #d4edda; color: #155724; }
        .accuracy-good { background: #d1ecf1; color: #0c5460; }
        .accuracy-fair { background: #fff3cd; color: #856404; }
        .accuracy-poor { background: #f8d7da; color: #721c24; }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .control-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .text-display {
                font-size: 1rem;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="static/icon.png" style="max-width: 100px; max-height: 100px; cursor: pointer;" onclick="window.location.pathname = '/';">
            <h1>ImagePeel's Type Test</h1>
            <p>Master your typing skills with comprehensive lessons and real-time feedback</p>
        </header>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value" id="wpm">0</div>
                <div class="stat-label">Words Per Minute</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="accuracy">100%</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-card">
                <div class="stat-value timer" id="timer">1:00</div>
                <div class="stat-label">Time Remaining</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="errors">0</div>
                <div class="stat-label">Errors</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-row">
                <div class="control-group">
                    <label for="difficulty">Difficulty:</label>
                    <select id="difficulty">
                        <option value="beginner">Beginner</option>
                        <option value="intermediate" selected>Intermediate</option>
                        <option value="advanced">Advanced</option>
                        <option value="expert">Expert</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="duration">Duration:</label>
                    <select id="duration">
                        <option value="30">30 seconds</option>
                        <option value="60" selected>1 minute</option>
                        <option value="120">2 minutes</option>
                        <option value="300">5 minutes</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="mode">Mode:</label>
                    <select id="mode">
                        <option value="words" selected>Words</option>
                        <option value="sentences">Sentences</option>
                        <option value="paragraphs">Paragraphs</option>
                        <option value="code">Code</option>
                    </select>
                </div>
                <button id="startBtn">Start Test</button>
                <button id="resetBtn">Reset</button>
            </div>
        </div>

        <div class="typing-area">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="text-display" id="textDisplay">
                Click "Start Test" to begin your typing practice session!
            </div>
            <div class="input-area">
                <input type="text" class="typing-input" id="typingInput" placeholder="Start typing here..." disabled>
            </div>
        </div>

        <div class="results" id="results">
            <h2>ðŸŽ‰ Test Complete!</h2>
            <div class="results-grid">
                <div class="stat-card">
                    <div class="stat-value" id="finalWpm">0</div>
                    <div class="stat-label">Final WPM</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="finalAccuracy">0%</div>
                    <div class="stat-label">Final Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalChars">0</div>
                    <div class="stat-label">Characters Typed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalErrors">0</div>
                    <div class="stat-label">Total Errors</div>
                </div>
            </div>
            <button id="retryBtn">Try Again</button>
        </div>

        <br>

        <div class="lesson-selector">
            <h3>ðŸ“š Typing Lessons</h3>
            <div class="lesson-grid">
                <div class="lesson-card" data-lesson="home-row">
                    <h4>Home Row Keys</h4>
                    <p>A S D F J K L ;</p>
                </div>
                <div class="lesson-card" data-lesson="top-row">
                    <h4>Top Row Keys</h4>
                    <p>Q W E R T Y U I O P</p>
                </div>
                <div class="lesson-card" data-lesson="bottom-row">
                    <h4>Bottom Row Keys</h4>
                    <p>Z X C V B N M</p>
                </div>
                <div class="lesson-card" data-lesson="numbers">
                    <h4>Numbers</h4>
                    <p>1 2 3 4 5 6 7 8 9 0</p>
                </div>
                <div class="lesson-card" data-lesson="symbols">
                    <h4>Symbols</h4>
                    <p>! @ # $ % ^ & * ( )</p>
                </div>
                <div class="lesson-card active" data-lesson="mixed">
                    <h4>Mixed Practice</h4>
                    <p>Complete sentences</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TypingTest {
            constructor() {
                this.currentText = '';
                this.currentPosition = 0;
                this.startTime = null;
                this.endTime = null;
                this.errors = 0;
                this.isActive = false;
                this.timer = null;
                this.timeRemaining = 60;
                this.selectedLesson = 'mixed';
                
                this.texts = {
                    beginner: {
                        words: ['the', 'and', 'for', 'are', 'but', 'not', 'you', 'all', 'can', 'had', 'her', 'was', 'one', 'our', 'out', 'day', 'get', 'has', 'him', 'his', 'how', 'man', 'new', 'now', 'old', 'see', 'two', 'way', 'who', 'boy', 'did', 'its', 'let', 'put', 'say', 'she', 'too', 'use', 'an', 'as', 'at', 'be', 'he', 'if', 'in', 'is', 'it', 'my', 'of', 'on', 'or', 'to', 'up', 'we', 'go', 'no', 'so', 'am', 'by', 'do', 'me', 'us', 'cat', 'dog', 'run', 'sit', 'big', 'red', 'hot', 'sun', 'car', 'eat', 'fun', 'hat', 'map', 'pen', 'top', 'win', 'yes', 'zoo'],
                        sentences: [
                            'The cat sat on the mat.',
                            'She has a red car.',
                            'We go to the park.',
                            'He likes to read books.',
                            'The sun is bright today.',
                            'I can see the blue sky.',
                            'Dogs like to play outside.',
                            'My mom makes good food.',
                            'The tree is very tall.',
                            'Birds fly in the air.',
                            'Fish swim in the water.',
                            'Kids play with their toys.',
                            'The ball is round and red.',
                            'We walk to school every day.',
                            'The house has a green door.',
                            'Cats sleep on soft beds.',
                            'The moon shines at night.',
                            'Flowers grow in the garden.',
                            'Rain falls from the clouds.',
                            'The book has many pages.'
                        ],
                        paragraphs: [
                            'The quick brown fox jumps over the lazy dog. This sentence contains every letter of the alphabet. It is often used for typing practice because it helps you learn all the keys on the keyboard.',
                            'Once upon a time, there was a little girl who lived in a small house by the woods. She loved to read books and play with her pet cat. Every morning, she would wake up early and help her mother in the garden.',
                            'Learning to type is like learning to ride a bike. At first, it feels hard and you make many mistakes. But with practice, your fingers will know where to go. Soon you will type fast without looking at the keys.',
                            'The park near my house has many trees and flowers. Children come here to play on the swings and slides. Families have picnics on the grass. Dogs run around and chase balls with their owners.'
                        ]
                    },
                    intermediate: {
                        words: ['about', 'would', 'there', 'could', 'other', 'after', 'first', 'never', 'these', 'think', 'where', 'being', 'every', 'great', 'might', 'shall', 'still', 'those', 'under', 'while', 'should', 'through', 'during', 'follow', 'around', 'place', 'right', 'came', 'show', 'also', 'back', 'good', 'each', 'well', 'large', 'turn', 'here', 'why', 'asked', 'went', 'men', 'read', 'need', 'land', 'different', 'home', 'move', 'try', 'kind', 'hand', 'picture', 'again', 'change', 'off', 'play', 'spell', 'air', 'away', 'animal', 'house', 'point', 'page', 'letter', 'mother', 'answer', 'found', 'study', 'still', 'learn', 'world', 'near', 'add', 'food', 'between', 'own', 'below', 'country', 'plant', 'last', 'school', 'father', 'keep', 'tree', 'never', 'start', 'city', 'earth', 'eye', 'light', 'thought', 'head', 'under', 'story', 'saw', 'left', 'dont', 'few', 'while', 'along', 'might', 'close', 'something', 'seem', 'next', 'hard', 'open', 'example', 'begin', 'life', 'always', 'those', 'both', 'paper', 'together', 'got', 'group', 'often', 'run'],
                        sentences: [
                            'The weather today is quite pleasant for a walk.',
                            'Programming requires patience and logical thinking.',
                            'She decided to learn a new language this year.',
                            'Technology has changed the way we communicate.',
                            'Reading books expands your knowledge and vocabulary.',
                            'The library offers many resources for students.',
                            'Exercise is important for maintaining good health.',
                            'Music can influence our emotions and mood.',
                            'Travel broadens your perspective on different cultures.',
                            'Cooking at home saves money and improves nutrition.',
                            'The internet provides access to unlimited information.',
                            'Teamwork often produces better results than individual effort.',
                            'Learning new skills requires dedication and practice.',
                            'Environmental protection is everyone\'s responsibility.',
                            'Art allows people to express their creativity.',
                            'Time management helps increase productivity.',
                            'Good communication skills are valuable in any career.',
                            'Regular exercise contributes to mental well-being.',
                            'Education opens doors to new opportunities.',
                            'Friendship requires trust and mutual respect.'
                        ],
                        paragraphs: [
                            'In the digital age, typing has become an essential skill for almost everyone. Whether you are a student, professional, or casual computer user, the ability to type quickly and accurately can significantly improve your productivity and efficiency in various tasks.',
                            'The art of cooking involves much more than simply following recipes. It requires understanding ingredients, timing, and techniques. A good cook learns to taste and adjust flavors, creating dishes that bring joy to family and friends.',
                            'Photography captures moments in time that would otherwise be lost forever. With modern digital cameras and smartphones, anyone can become a photographer. The key is learning to see the world through the lens and understanding how light affects the image.',
                            'Exercise is not just about physical fitness; it also benefits mental health. Regular physical activity releases endorphins, which are natural mood boosters. Whether it\'s walking, swimming, or playing sports, movement is medicine for both body and mind.',
                            'Reading is one of the most powerful tools for personal growth. Books transport us to different worlds, introduce us to new ideas, and help us understand perspectives different from our own. A good book can change the way we think about life.'
                        ]
                    },
                    advanced: {
                        words: ['although', 'between', 'important', 'different', 'following', 'through', 'another', 'because', 'without', 'against', 'nothing', 'someone', 'around', 'during', 'before', 'something', 'thought', 'both', 'together', 'place', 'development', 'government', 'management', 'environment', 'information', 'organization', 'community', 'technology', 'education', 'experience', 'individual', 'particular', 'relationship', 'understand', 'available', 'including', 'according', 'business', 'increase', 'research', 'university', 'political', 'economic', 'financial', 'cultural', 'social', 'natural', 'medical', 'scientific', 'historical', 'international', 'national', 'regional', 'local', 'personal', 'professional', 'traditional', 'modern', 'current', 'future', 'potential', 'significant', 'successful', 'effective', 'efficient', 'creative', 'innovative', 'competitive', 'collaborative', 'comprehensive', 'fundamental', 'essential', 'critical', 'strategic', 'systematic', 'analytical', 'theoretical', 'practical', 'technical', 'digital', 'electronic', 'mechanical', 'chemical', 'biological', 'psychological', 'philosophical', 'mathematical', 'statistical', 'geographical', 'architectural', 'agricultural', 'industrial', 'commercial', 'residential', 'educational', 'recreational', 'environmental', 'sustainable', 'renewable', 'responsible', 'accountable', 'transparent', 'democratic', 'diplomatic', 'strategic'],
                        sentences: [
                            'The implementation of artificial intelligence requires sophisticated algorithms.',
                            'Quantum computing represents a paradigm shift in computational capabilities.',
                            'Sustainable development goals aim to address global environmental challenges.',
                            'Cryptocurrency blockchain technology offers decentralized financial solutions.',
                            'Machine learning algorithms can analyze vast amounts of data efficiently.',
                            'Climate change mitigation strategies require international cooperation and commitment.',
                            'Biotechnology innovations are revolutionizing healthcare and pharmaceutical industries.',
                            'Renewable energy sources are becoming increasingly cost-effective and accessible.',
                            'Digital transformation is reshaping traditional business models across industries.',
                            'Cybersecurity measures must evolve to counter sophisticated cyber threats.',
                            'Artificial neural networks mimic biological brain functions for pattern recognition.',
                            'Globalization has interconnected economies and cultures worldwide.',
                            'Nanotechnology applications span from medicine to electronics manufacturing.',
                            'Virtual reality technology creates immersive experiences for education and entertainment.',
                            'Genetic engineering techniques offer potential solutions for inherited diseases.',
                            'Space exploration missions expand our understanding of the universe.',
                            'Autonomous vehicles integrate sensors, AI, and advanced navigation systems.',
                            'Precision medicine tailors treatments based on individual genetic profiles.',
                            'Internet of Things devices collect and transmit data for smart city applications.',
                            'Augmented reality overlays digital information onto the physical world.'
                        ],
                        paragraphs: [
                            'The rapid advancement of technology in the twenty-first century has fundamentally transformed how we interact with information, conduct business, and maintain social relationships. From artificial intelligence and machine learning to blockchain and quantum computing, these innovations continue to reshape industries and create new opportunities for growth and development.',
                            'Climate change represents one of the most pressing challenges of our time, requiring coordinated global action across multiple sectors. The transition to renewable energy sources, implementation of carbon capture technologies, and development of sustainable agricultural practices are essential components of comprehensive climate mitigation strategies.',
                            'The field of biotechnology has experienced unprecedented growth, with applications ranging from personalized medicine to agricultural enhancement. CRISPR gene editing technology, synthetic biology, and advanced drug delivery systems are revolutionizing how we approach healthcare, food security, and environmental conservation.',
                            'Digital transformation has become a critical imperative for organizations seeking to remain competitive in an increasingly connected world. Cloud computing, big data analytics, and artificial intelligence are enabling businesses to optimize operations, enhance customer experiences, and develop innovative products and services.',
                            'The exploration of space continues to capture human imagination while driving technological innovation. Mars colonization missions, asteroid mining ventures, and the search for extraterrestrial life represent ambitious endeavors that push the boundaries of human knowledge and capability.'
                        ]
                    },
                    expert: {
                        words: ['extraordinary', 'philosophical', 'unprecedented', 'revolutionary', 'sophisticated', 'comprehensive', 'implementation', 'infrastructure', 'transformation', 'characteristics', 'responsibilities', 'opportunities', 'environmental', 'technological', 'international', 'organizational', 'psychological', 'administrative', 'constitutional', 'representative', 'entrepreneurial', 'interdisciplinary', 'multidimensional', 'counterproductive', 'disproportionate', 'incomprehensible', 'indistinguishable', 'uncharacteristic', 'unconventional', 'uncompromising', 'consciousness', 'subconscious', 'unconscious', 'self-consciousness', 'metacognition', 'epistemology', 'phenomenology', 'hermeneutics', 'existentialism', 'postmodernism', 'structuralism', 'deconstructionism', 'constructivism', 'empiricism', 'rationalism', 'pragmatism', 'utilitarianism', 'deontology', 'consequentialism', 'virtue ethics', 'bioethics', 'neuroethics', 'environmental ethics', 'business ethics', 'medical ethics', 'research ethics', 'artificial intelligence', 'machine learning', 'deep learning', 'neural networks', 'natural language processing', 'computer vision', 'robotics', 'automation', 'digitization', 'virtualization', 'augmentation', 'optimization', 'maximization', 'minimization', 'standardization', 'normalization', 'regularization', 'generalization', 'specialization', 'diversification', 'globalization', 'localization', 'personalization', 'customization', 'democratization', 'decentralization', 'centralization', 'federalization', 'privatization', 'nationalization', 'commercialization', 'industrialization', 'modernization', 'urbanization', 'suburbanization', 'gentrification', 'revitalization', 'rehabilitation', 'reconstruction', 'deconstruction', 'transformation', 'reformation', 'revolution', 'evolution', 'devolution', 'involution'],
                        sentences: [
                            'The interdisciplinary approach facilitates comprehensive understanding of complex phenomena.',
                            'Neuroplasticity demonstrates the brain\'s remarkable capacity for adaptation and reorganization.',
                            'Epistemological frameworks influence methodological approaches in scientific research.',
                            'Socioeconomic disparities necessitate multifaceted policy interventions and systemic reforms.',
                            'Phenomenological investigations explore subjective experiences and consciousness structures.',
                            'Quantum entanglement exhibits non-local correlations that challenge classical physics paradigms.',
                            'Bioengineering applications integrate molecular biology with mechanical engineering principles.',
                            'Postmodern architectural movements deconstruct traditional spatial and aesthetic conventions.',
                            'Computational linguistics algorithms process natural language through statistical and symbolic methods.',
                            'Neuropharmacological interventions modulate synaptic transmission and neurochemical pathways.',
                            'Geopolitical realignments reflect shifting power dynamics in international relations.',
                            'Metacognitive strategies enhance learning efficiency through self-regulated study techniques.',
                            'Thermodynamic principles govern energy transformations in biological and mechanical systems.',
                            'Anthropological ethnographies document cultural practices and social organizational structures.',
                            'Psycholinguistic research investigates cognitive processes underlying language acquisition and production.',
                            'Econometric models quantify relationships between macroeconomic variables and policy outcomes.',
                            'Historiographical methodologies examine how historical narratives are constructed and interpreted.',
                            'Phenomenological reduction brackets natural attitudes to examine pure consciousness.',
                            'Biotechnological innovations leverage genetic engineering for therapeutic and agricultural applications.',
                            'Epistemological relativism questions the universality of knowledge claims and truth conditions.'
                        ],
                        paragraphs: [
                            'Contemporary epistemological discourse encompasses a multitude of theoretical frameworks that attempt to elucidate the fundamental nature of knowledge acquisition, validation, and dissemination. These philosophical investigations, ranging from empiricist traditions to constructivist paradigms, continue to influence methodological approaches across diverse academic disciplines and professional domains.',
                            'The emergence of quantum computing represents a paradigmatic shift in computational theory and practice, challenging classical assumptions about information processing and algorithmic complexity. Quantum superposition, entanglement, and decoherence phenomena enable unprecedented computational capabilities while simultaneously introducing novel theoretical and practical challenges.',
                            'Neuroscientific research has revealed the extraordinary plasticity of the human brain, demonstrating its capacity for structural and functional reorganization throughout the lifespan. These discoveries have profound implications for understanding learning, memory, recovery from injury, and the development of therapeutic interventions for neurological and psychiatric disorders.',
                            'The intersection of artificial intelligence and bioethics raises fundamental questions about consciousness, moral agency, and the nature of human-machine relationships. As AI systems become increasingly sophisticated, society must grapple with complex ethical dilemmas regarding autonomy, responsibility, privacy, and the potential for technological enhancement of human capabilities.',
                            'Postcolonial literary theory examines how colonial experiences have shaped cultural identity, language, and narrative structures in formerly colonized societies. This critical framework reveals the complex dynamics of power, resistance, and cultural hybridity that characterize postcolonial literature and its relationship to dominant Western literary traditions.'
                        ]
                    }
                };

                this.lessonTexts = {
                    'home-row': 'asdf jkl; asdf jkl; sad lad ask dad fall jaklas fads jaks falls lads asks dads flask glass slash flash dash gash hash lash sash dash flask glass slash flash dash gash hash lash sash dash ask lad sad dad fall all hall shall fall all hall shall ask lad sad dad',
                    'top-row': 'qwer tyui op qwer tyui op quit port wipe riot your tire pier quit port wipe riot query power tower lower upper outer inner winter writer porter quarter pewter trooper trouperouperrouper trooper troupe rouper trooper troupe rouper query power tower lower upper outer inner winter writer porter quarter pewter',
                    'bottom-row': 'zxcv bnm zxcv bnm zinc box cave venom maze next comb vixen zone box cave venom zinc maven cabin cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven cabin maven',
                    'numbers': '1234 5678 90 1234 5678 90 12 34 56 78 90 123 456 789 012 345 678 901 234 567 890 123 456 789 012 345 678 901 234 567 890 123 456 789 012 345 678 901 234 567 890 123 456 789 012 345 678 901 234 567 890 123 456 789 012 345 678 901 234 567 890',
                    'symbols': '!@#$ %^&* () !@#$ %^&* () !@ #$ %^ &* () !@# $%^ &*( ) !@#$ %^&* () []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/ []{}|\\:";\'<>,.?/',
                    'mixed': null
                };

                this.codeSnippets = [
                    'function calculateSum(a, b) { return a + b; }',
                    'const array = [1, 2, 3, 4, 5]; array.map(x => x * 2);',
                    'if (condition === true) { console.log("Hello World"); }',
                    'for (let i = 0; i < 10; i++) { process(data[i]); }',
                    'class MyClass { constructor(name) { this.name = name; } }',
                    'const fetchData = async () => { const response = await fetch("/api/data"); return response.json(); };',
                    'const users = data.filter(user => user.age >= 18).sort((a, b) => a.name.localeCompare(b.name));',
                    'try { const result = JSON.parse(jsonString); } catch (error) { console.error("Invalid JSON:", error); }',
                    'const debounce = (func, delay) => { let timeoutId; return (...args) => { clearTimeout(timeoutId); timeoutId = setTimeout(() => func.apply(this, args), delay); }; };',
                    'import React, { useState, useEffect } from "react"; const Component = () => { const [count, setCount] = useState(0); return <div>{count}</div>; };',
                    'SELECT users.name, COUNT(orders.id) as order_count FROM users LEFT JOIN orders ON users.id = orders.user_id GROUP BY users.id;',
                    'def fibonacci(n): return n if n <= 1 else fibonacci(n-1) + fibonacci(n-2)',
                    'public class Calculator { private int result; public int add(int a, int b) { return result = a + b; } }',
                    'const express = require("express"); const app = express(); app.get("/", (req, res) => res.send("Hello World")); app.listen(3000);',
                    'git add . && git commit -m "Initial commit" && git push origin main',
                    'docker run -d -p 8080:80 --name my-app nginx:latest',
                    'npm install express mongoose dotenv && npm start',
                    'curl -X POST -H "Content-Type: application/json" -d \'{"name":"John"}\' https://api.example.com/users',
                    'const promise = new Promise((resolve, reject) => { setTimeout(() => resolve("Success!"), 1000); });',
                    'interface User { id: number; name: string; email?: string; } const user: User = { id: 1, name: "Alice" };',
                    'CREATE TABLE users (id SERIAL PRIMARY KEY, name VARCHAR(100) NOT NULL, email VARCHAR(255) UNIQUE, created_at TIMESTAMP DEFAULT NOW());',
                    'body { margin: 0; padding: 0; font-family: Arial, sans-serif; } .container { max-width: 1200px; margin: 0 auto; }',
                    'const reducer = (state, action) => { switch(action.type) { case "INCREMENT": return { count: state.count + 1 }; default: return state; } };',
                    'import pandas as pd; df = pd.read_csv("data.csv"); result = df.groupby("category").agg({"price": "mean", "quantity": "sum"});',
                    'package main; import "fmt"; func main() { fmt.Println("Hello, World!") }',
                    'use std::collections::HashMap; fn main() { let mut map = HashMap::new(); map.insert("key", "value"); }',
                    'from sklearn.model_selection import train_test_split; X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2);',
                    'const WebSocket = require("ws"); const wss = new WebSocket.Server({ port: 8080 }); wss.on("connection", ws => ws.send("Welcome!"));',
                    'terraform init && terraform plan && terraform apply -auto-approve',
                    'kubectl create deployment my-app --image=nginx && kubectl expose deployment my-app --port=80 --type=LoadBalancer'
                ];

                this.initializeElements();
                this.bindEvents();
                this.generateText();
            }

            initializeElements() {
                this.elements = {
                    startBtn: document.getElementById('startBtn'),
                    resetBtn: document.getElementById('resetBtn'),
                    retryBtn: document.getElementById('retryBtn'),
                    typingInput: document.getElementById('typingInput'),
                    textDisplay: document.getElementById('textDisplay'),
                    wpm: document.getElementById('wpm'),
                    accuracy: document.getElementById('accuracy'),
                    timer: document.getElementById('timer'),
                    errors: document.getElementById('errors'),
                    results: document.getElementById('results'),
                    progressFill: document.getElementById('progressFill'),
                    difficulty: document.getElementById('difficulty'),
                    duration: document.getElementById('duration'),
                    mode: document.getElementById('mode'),
                    finalWpm: document.getElementById('finalWpm'),
                    finalAccuracy: document.getElementById('finalAccuracy'),
                    totalChars: document.getElementById('totalChars'),
                    totalErrors: document.getElementById('totalErrors')
                };
            }

            bindEvents() {
                this.elements.startBtn.addEventListener('click', () => this.startTest());
                this.elements.resetBtn.addEventListener('click', () => this.resetTest());
                this.elements.retryBtn.addEventListener('click', () => this.retryTest());
                this.elements.typingInput.addEventListener('input', (e) => this.handleInput(e));
                this.elements.difficulty.addEventListener('change', () => this.generateText());
                this.elements.mode.addEventListener('change', () => this.generateText());
                this.elements.duration.addEventListener('change', () => this.updateTimer());

                document.querySelectorAll('.lesson-card').forEach(card => {
                    card.addEventListener('click', () => {
                        document.querySelectorAll('.lesson-card').forEach(c => c.classList.remove('active'));
                        card.classList.add('active');
                        this.selectedLesson = card.dataset.lesson;
                        this.generateText();
                    });
                });

                this.elements.typingInput.addEventListener('contextmenu', (e) => e.preventDefault());
                this.elements.typingInput.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && (e.key === 'v' || e.key === 'c' || e.key === 'x')) {
                        e.preventDefault();
                    }
                });
            }

            generateText() {
                const difficulty = this.elements.difficulty.value;
                const mode = this.elements.mode.value;
                
                if (this.selectedLesson !== 'mixed') {
                    this.currentText = this.lessonTexts[this.selectedLesson];
                } else if (mode === 'code') {
                    this.currentText = this.codeSnippets[Math.floor(Math.random() * this.codeSnippets.length)];
                } else {
                    const textPool = this.texts[difficulty][mode];
                    if (mode === 'words') {
                        const wordCount = 50;
                        const selectedWords = [];
                        for (let i = 0; i < wordCount; i++) {
                            selectedWords.push(textPool[Math.floor(Math.random() * textPool.length)]);
                        }
                        this.currentText = selectedWords.join(' ');
                    } else {
                        this.currentText = textPool[Math.floor(Math.random() * textPool.length)];
                    }
                }

                this.displayText();
                this.resetStats();
            }

            displayText() {
                const chars = this.currentText.split('');
                this.elements.textDisplay.innerHTML = chars.map((char, index) => 
                    `<span class="char" data-index="${index}">${char === ' ' ? '&nbsp;' : char}</span>`
                ).join('');
            }

            startTest() {
                this.isActive = true;
                this.startTime = new Date();
                this.elements.typingInput.disabled = false;
                this.elements.typingInput.focus();
                this.elements.startBtn.disabled = true;
                this.elements.results.classList.remove('show');
                
                this.timeRemaining = parseInt(this.elements.duration.value);
                this.startTimer();
                
                const firstChar = document.querySelector('.char[data-index="0"]');
                if (firstChar) {
                    firstChar.classList.add('current');
                }
            }

            startTimer() {
                this.updateTimerDisplay();
                this.timer = setInterval(() => {
                    this.timeRemaining--;
                    this.updateTimerDisplay();
                    
                    if (this.timeRemaining <= 0) {
                        this.endTest();
                    }
                }, 1000);
            }

            updateTimer() {
                this.timeRemaining = parseInt(this.elements.duration.value);
                this.updateTimerDisplay();
            }

            updateTimerDisplay() {
                const minutes = Math.floor(this.timeRemaining / 60);
                const seconds = this.timeRemaining % 60;
                this.elements.timer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }

            handleInput(e) {
                if (!this.isActive) return;

                const inputValue = e.target.value;
                const currentChar = this.currentText[this.currentPosition];
                const typedChar = inputValue[inputValue.length - 1];

                document.querySelectorAll('.char').forEach(char => {
                    char.classList.remove('current', 'correct', 'incorrect');
                });

                for (let i = 0; i < inputValue.length; i++) {
                    const char = document.querySelector(`.char[data-index="${i}"]`);
                    if (char) {
                        if (inputValue[i] === this.currentText[i]) {
                            char.classList.add('correct');
                        } else {
                            char.classList.add('incorrect');
                            if (i === inputValue.length - 1) {
                                this.errors++;
                            }
                        }
                    }
                }

                const nextChar = document.querySelector(`.char[data-index="${inputValue.length}"]`);
                if (nextChar) {
                    nextChar.classList.add('current');
                }

                this.currentPosition = inputValue.length;
                this.updateStats();
                this.updateProgress();

                if (inputValue.length >= this.currentText.length) {
                    this.endTest();
                }
            }

            updateStats() {
                const timeElapsed = (new Date() - this.startTime) / 1000 / 60;
                const wordsTyped = this.elements.typingInput.value.length / 5;
                const wpm = timeElapsed > 0 ? Math.round(wordsTyped / timeElapsed) : 0;
                
                const totalChars = this.elements.typingInput.value.length;
                const accuracy = totalChars > 0 ? Math.round(((totalChars - this.errors) / totalChars) * 100) : 100;

                this.elements.wpm.textContent = wpm;
                this.elements.accuracy.textContent = accuracy + '%';
                this.elements.errors.textContent = this.errors;

                const accuracyElement = this.elements.accuracy;
                accuracyElement.className = 'stat-value';
                if (accuracy >= 95) accuracyElement.classList.add('accuracy-excellent');
                else if (accuracy >= 85) accuracyElement.classList.add('accuracy-good');
                else if (accuracy >= 70) accuracyElement.classList.add('accuracy-fair');
                else accuracyElement.classList.add('accuracy-poor');
            }

            updateProgress() {
                const progress = (this.currentPosition / this.currentText.length) * 100;
                this.elements.progressFill.style.width = progress + '%';
            }

            endTest() {
                this.isActive = false;
                this.endTime = new Date();
                this.elements.typingInput.disabled = true;
                this.elements.startBtn.disabled = false;
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }

                this.showResults();
            }

            showResults() {
                const timeElapsed = (this.endTime - this.startTime) / 1000 / 60;
                const wordsTyped = this.elements.typingInput.value.length / 5;
                const finalWpm = timeElapsed > 0 ? Math.round(wordsTyped / timeElapsed) : 0;
                const totalChars = this.elements.typingInput.value.length;
                const finalAccuracy = totalChars > 0 ? Math.round(((totalChars - this.errors) / totalChars) * 100) : 100;

                this.elements.finalWpm.textContent = finalWpm;
                this.elements.finalAccuracy.textContent = finalAccuracy + '%';
                this.elements.totalChars.textContent = totalChars;
                this.elements.totalErrors.textContent = this.errors;

                this.elements.results.classList.add('show');
            }

            resetTest() {
                this.isActive = false;
                this.currentPosition = 0;
                this.errors = 0;
                this.startTime = null;
                this.endTime = null;
                
                if (this.timer) {
                    clearInterval(this.timer);
                    this.timer = null;
                }

                this.elements.typingInput.value = '';
                this.elements.typingInput.disabled = true;
                this.elements.startBtn.disabled = false;
                this.elements.results.classList.remove('show');
                
                this.timeRemaining = parseInt(this.elements.duration.value);
                this.updateTimerDisplay();
                this.generateText();
                this.resetStats();
            }

            retryTest() {
                this.resetTest();
                setTimeout(() => this.startTest(), 100);
            }

            resetStats() {
                this.elements.wpm.textContent = '0';
                this.elements.accuracy.textContent = '100%';
                this.elements.errors.textContent = '0';
                this.elements.progressFill.style.width = '0%';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new TypingTest();
        });
    </script>
</body>
</html>
